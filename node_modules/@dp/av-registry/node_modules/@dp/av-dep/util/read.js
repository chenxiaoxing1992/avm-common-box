var UglifyJS = require("uglify-js");
var EXTERNALS_KEY = "externals";
var WEBPACK_KEY = "webpack";

module.exports = function(content){
	var ast = UglifyJS.parse(content);
	var result = {};
	ast.walk(new UglifyJS.TreeWalker(function(node){
	    if(node instanceof UglifyJS.AST_Call && node.expression.name == WEBPACK_KEY ){
	   		var webpackArgs = node.args[0].properties;
	   		webpackArgs.some(function(item,index){
	   			if(item.key == EXTERNALS_KEY){
	   				var  externalsArgs= item.value.properties;
	   				externalsArgs.forEach(function(it,key){
	   					result[it.key] = it.value.value;
	   				})
	   				return true;
	   			}
	   		})
	   	}
	}));
	return result;
}